"use strict";(self.webpackChunkBrainDriveWhyDetector=self.webpackChunkBrainDriveWhyDetector||[]).push([[5],{5:(e,n,t)=>{t.r(n),t.d(n,{BrainDriveWhyDetector:()=>O,default:()=>R});var r=t(848),s=t(769),o=t.n(s),a=t(515),i=t(969),l=t(72),c=t.n(l),h=t(825),d=t.n(h),p=t(659),m=t.n(p),g=t(56),u=t.n(g),b=t(159),x=t.n(b),f=t(113),y=t.n(f),v=t(423),w={};function S(e="id"){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}w.styleTagTransform=y(),w.setAttributes=u(),w.insert=m().bind(null,"head"),w.domAPI=d(),w.insertStyleElement=x(),c()(v.A,w),v.A&&v.A.locals&&v.A.locals;const E=10,T=10,N={ollama:"ollama_servers_settings",anthropic:"anthropic_api_settings",openai:"openai_api_settings",openrouter:"openrouter_api_settings"};class k{constructor(e){this.currentUserId=null,this.services=e,this.initializeUserId()}async initializeUserId(){try{if(this.services?.api){const e=await this.services.api.get("/api/v1/auth/me");e?.id&&(this.currentUserId=e.id)}}catch(e){console.error("WhyDetector AIService: Error getting user ID:",e)}}async fetchModels(){if(!this.services?.api)return console.error("WhyDetector AIService: API service not available"),[];try{const e=await this.services.api.get("/api/v1/ai/providers/all-models"),n=e?.models||e?.data?.models||(Array.isArray(e)?e:[]),t=Array.isArray(n)?n.map(e=>{const n=e.provider||"ollama";return{name:e.name||e.id||"",provider:n,providerId:N[n]||n,serverName:e.server_name||e.serverName||"Unknown Server",serverId:e.server_id||e.serverId||"unknown"}}):[];return console.log(`WhyDetector AIService: Loaded ${t.length} models`),t}catch(e){return console.error("WhyDetector AIService: Error fetching models:",e),this.fetchOllamaModelsFallback()}}async fetchOllamaModelsFallback(){try{const e=await this.services.api.get("/api/v1/settings/instances",{params:{definition_id:"ollama_servers_settings",scope:"user",user_id:"current"}});let n=null;if(Array.isArray(e)&&e.length>0?n=e[0]:e?.data&&(n=Array.isArray(e.data)?e.data[0]:e.data),!n?.value)return[];const t="string"==typeof n.value?JSON.parse(n.value):n.value,r=Array.isArray(t?.servers)?t.servers:[],s=[];for(const e of r)try{const n={server_url:encodeURIComponent(e.serverAddress),settings_id:"ollama_servers_settings",server_id:e.id};e.apiKey&&(n.api_key=e.apiKey);const t=await this.services.api.get("/api/v1/ollama/models",{params:n}),r=Array.isArray(t)?t:[];for(const n of r)s.push({name:n.name,provider:"ollama",providerId:"ollama_servers_settings",serverName:e.serverName,serverId:e.id})}catch(n){console.error("WhyDetector AIService: Error loading models for server",e?.serverName,n)}return s}catch(e){return console.error("WhyDetector AIService: Fallback model fetch failed:",e),[]}}async sendToCoach(e,n,t,r,s,o,a){if(!this.services?.api)throw new Error("API service not available");const i=function(e,n,t){return function(e,n,t){const r=function(e){switch(e){case"intro":return'PHASE: Getting Started (3+ exchanges)\n\nGOAL: Understand who they are and why they came here.\n\nQUALITY CHECK:\nIf their answer is vague or short, ask for more:\n- "Can you tell me more about that?"\n- "What specifically prompted this?"\n- "Help me understand - what does that look like for you?"\n\nDo NOT accept surface-level answers like "just curious" or "feeling stuck".\nDig into the specifics.\n\nAfter 3+ meaningful exchanges, move to asking about what energizes them.\n';case"energy_map":return'PHASE: Energy Mapping (4+ exchanges)\n\nGOAL: Find what energizes and drains them with DEPTH.\n\nQUALITY CHECK - CRITICAL:\nIf they give a generic answer like "I like helping people" or "meetings drain me":\n- Do NOT accept this as complete\n- Say: "I need more specifics here. Can you give me a concrete example?"\n- Ask: "When was a specific time this happened? Walk me through it."\n\nYou need SPECIFIC examples, not general statements.\n\nWHAT TO EXPLORE:\n- What makes them feel alive? (Get a specific moment)\n- What makes them feel drained? (Get a specific moment)\n- WHY for each - what specifically about it?\n\nAfter 4+ exchanges with real depth, move to stories.\n';case"stories":return'PHASE: Stories (3+ exchanges)\n\nGOAL: Get 1-2 specific stories with emotional depth.\n\nQUALITY CHECK:\nIf their story lacks detail or emotion:\n- "I want to really understand this moment. Can you paint the picture for me?"\n- "What were you feeling in that moment?"\n- "Why did this stick with you?"\n\nA good story has:\n- Specific details (when, where, who)\n- Emotional content (how they felt)\n- Meaning (why it mattered)\n\nIf they only give you surface-level descriptions, keep asking until you get the emotional core.\n\nAfter 3+ exchanges with real stories, move to synthesizing their Why.\n';case"your_why":return'PHASE: Finding Your Why (FINAL)\n\nYOU MUST DO ONE OF THESE TWO THINGS:\n\nOPTION A - IF STILL EXPLORING:\nAsk a question. End with "?"\nExample: "Does this pattern resonate with you?"\n\nOPTION B - IF USER CONFIRMED (said "yes", "that\'s it", "feels right"):\nDeliver the final Why statement and END.\nYou MUST say:\n"YOUR WHY IS: To [contribution] so that [impact].\n\nThank you for sharing so openly. This came from your real experiences - [mention 1-2 specific things they said]. Write this down and let it guide your decisions."\n\nTHERE IS NO OPTION C.\nEither ask a question (?) or deliver the final Why and thank them.\nDo not just repeat a statement without a question.\nDo not leave without delivering the Why.\n\nIF USER SAYS "yes" OR CONFIRMS:\nThis is your signal to IMMEDIATELY deliver the final Why.\nDo not ask more questions.\nDo not repeat the statement.\nDeliver it formally with "YOUR WHY IS:" and thank them.\n\nEXAMPLE OF WHAT TO DO WHEN USER SAYS "yes":\n\nUser: "yes"\nYou: "YOUR WHY IS: To shape and create so that your unique thinking leaves a lasting impact.\n\nThank you for this conversation. You shared how meaningful it is to build from the ground up, to have ownership, and to see your work matter. Hold onto this. It\'s yours."\n\nDO NOT just repeat the Why without the formal delivery and thank you.\n';case"completed":return"Session complete. Their Why has been found. Celebrate briefly.";default:return""}}(e),s=t.filter(e=>"user"===e.role).length,o=s>=T,a=t.filter(e=>"user"===e.role).pop()?.content?.toLowerCase()||"",i="your_why"===e&&["yes","yeah","yep","that's it","thats it","feels right","that works","perfect","exactly","correct"].some(e=>a.includes(e))&&a.length<50;let l=`You are a warm, supportive coach helping someone discover their Why.\n\nCRITICAL RULES - FOLLOW EXACTLY:\n\n1. ASK ONE NEW QUESTION\n   - Every response must end with a question mark (?)\n   - Ask something you have NOT asked before\n   - If you catch yourself asking the same thing, change it\n\n2. NO REPEATING\n   - Read the conversation history carefully\n   - Do NOT ask the same question twice\n   - Do NOT rephrase a previous question\n   - Each question must explore something NEW\n\n3. RESPONSE FORMAT\n   - 1-2 sentences acknowledging what they said\n   - 1 sentence of insight or reflection\n   - 1 NEW question ending with ?\n   - Keep it SHORT (3-4 sentences total)\n\n4. "YOUR WHY IS:" - ONLY AT THE END\n   - Do NOT say "YOUR WHY IS:" until user has shared 10+ messages\n   - When you do give the Why, do NOT ask another question\n   - Thank them and end the conversation\n\n5. BE WARM AND HUMAN\n   - Acknowledge their feelings\n   - Show you understood what they said\n   - Be curious, not interrogating\n\nGOOD RESPONSE:\n"That sounds meaningful - getting absorbed in solving undefined problems where you can shape the solution. What was it about that specific challenge that made hours fly by? Was it the freedom, the creativity, or something else?"\n\nBAD RESPONSE (repeats):\n"Tell me more about feeling engaged" (if you already asked this)\n\nBAD RESPONSE (no question):\n"You clearly value creative problem-solving."\n\nBAD RESPONSE (premature why):\n"YOUR WHY IS: To solve problems creatively." (too early!)\n\n\nCURRENT PHASE: ${e.toUpperCase()}\n${r}\n\nCONVERSATION STATUS:\n- Exchanges so far: ${s}\n- Minimum needed: ${E}\n- Ready to conclude: ${o?"YES":"NO - NEED MORE CONVERSATION"}`;return"your_why"!==e||o||(l+=`\n\n*** QUALITY CHECK: NOT READY ***\nYou only have ${s} exchanges. You need at least ${T}.\nDO NOT propose a Why statement yet.\nKeep asking questions to understand them better.\nAsk about:\n- Specific moments that mattered to them\n- What made those moments meaningful\n- What they want their work to feel like`),i&&o?l+=`\n\n*** USER CONFIRMED - DELIVER FINAL WHY ***\nThe user said "${a}" - they accept the Why statement.\nYOU MUST NOW:\n1. Say "YOUR WHY IS: [the Why statement you proposed]"\n2. Thank them warmly\n3. Reference 1-2 specific things they shared\n4. Do NOT ask another question\n5. This is the END`:i&&!o&&(l+=`\n\n*** USER SAID YES BUT NOT ENOUGH DATA ***\nThe user seems to agree, but you only have ${s} exchanges.\nSay: "I appreciate that resonates, but I want to make sure we capture the full picture. Let me ask one more thing..."\nThen ask another question.`),l}(e,0,t)}(n,0,r),l=r.filter(e=>"user"===e.role).length+1;let c;c=l>=12?`[CRITICAL INSTRUCTION - THIS IS EXCHANGE #${l}]\n\nYOU MUST NOW DELIVER THE WHY STATEMENT WITH DETAILED BREAKDOWN.\nDO NOT ASK ANY MORE QUESTIONS. THIS IS THE END.\n\nAnalyze the entire conversation and create their Why statement with analysis.\n\nYOUR RESPONSE FORMAT (follow exactly):\n\n**What I Learned About You:**\n[2-3 sentences summarizing key insights from conversation]\n\n**The Patterns I See:**\n- [Pattern 1: what energizes them]\n- [Pattern 2: what they value]\n- [Pattern 3: what impact they want]\n\n**YOUR WHY IS:**\nTo [their contribution/action] so that [the impact/outcome they create for others]\n\n**Why This Fits You:**\n[2-3 sentences explaining how this Why connects to specific things they shared]\n\nThank you for sharing so openly. This Why came from your real experiences and insights.\n\nIMPORTANT: DO NOT ask any questions. No "?" anywhere. This is the final message.\n\nUSER'S FINAL MESSAGE:\n`:`[INSTRUCTION - Exchange #${l} of 12]\nAsk ONE new question. Do NOT repeat previous questions. Keep it short.\n\nUSER MESSAGE:\n`;const h=[{role:"system",content:i},...r,{role:"user",content:c+e}],d={provider:s.provider||"ollama",settings_id:s.providerId||"ollama_servers_settings",server_id:s.serverId,model:s.name,messages:h,params:{temperature:.7,max_tokens:2048},stream:!0,user_id:this.currentUserId||"current",conversation_type:"whydetector"};try{if("function"==typeof this.services.api.postStreaming)await this.services.api.postStreaming("/api/v1/ai/providers/chat",d,e=>{if(a?.signal.aborted)return;let n=e;if(e.startsWith("data: ")&&(n=e.substring(6)),n.trim()&&"[DONE]"!==n.trim())try{const e=JSON.parse(n),t=this.extractTextFromResponse(e);t&&o(t)}catch(e){n.trim()&&o(n)}},{timeout:12e4,signal:a?.signal});else{const e=await this.services.api.post("/api/v1/ai/providers/chat",{...d,stream:!1},{timeout:6e4}),n=this.extractTextFromResponse(e?.data||e);n&&o(n)}}catch(e){if(e instanceof Error&&"AbortError"===e.name)throw e;throw console.error("WhyDetector AIService: Coach request failed:",e),e}}extractTextFromResponse(e){return e?"string"==typeof e?e:e.text?e.text:e.content?e.content:e.response?e.response:e.message?.content?e.message.content:e.choices?.[0]?.message?.content?e.choices[0].message.content:e.choices?.[0]?.delta?.content?e.choices[0].delta.content:e.message?.content?e.message.content:"":""}buildContext(e){return e.map(e=>({role:"user"===e.sender?"user":"assistant",content:e.content}))}}const A={energizers:[],drainers:[],stories:[],whyStatement:""};class I extends s.Component{constructor(e){super(e),this.aiService=null,this.abortController=null,this.themeChangeListener=null,this.autoStartSession=async()=>{const{models:e}=this.state;e.length>0&&this.setState({sessionStarted:!0,selectedModel:e[0],currentPhase:"intro",messages:[],sessionData:{...A}},()=>{this.sendCoachMessage("START_SESSION")})},this.sendCoachMessage=async e=>{const{selectedModel:n,currentPhase:t,sessionData:r,messages:s}=this.state;if(!this.aiService||!n)return void this.setState({error:"No model selected"});if("START_SESSION"!==e){const n={id:S("msg"),sender:"user",content:e,timestamp:(new Date).toISOString(),phase:t};this.setState(e=>({messages:[...e.messages,n]}))}const o=S("msg"),a={id:o,sender:"coach",content:"START_SESSION"===e?"Hey! I am here to help you discover your Why, your core purpose.\n\nWe will have a quick conversation about what energizes you, what drains you, and find patterns that reveal what matters to you.\n\nSo tell me, what do you do right now, and what made you curious about finding your why?":"",timestamp:(new Date).toISOString(),isStreaming:"START_SESSION"!==e,phase:t};if(this.setState(n=>({messages:[...n.messages,a],isLoading:!0,isStreaming:"START_SESSION"!==e,inputText:""})),"START_SESSION"!==e){this.abortController=new AbortController;try{const a=this.aiService.buildContext(s);await this.aiService.sendToCoach(e,t,r,a,n,e=>{this.setState(n=>({messages:n.messages.map(n=>n.id===o?{...n,content:n.content+e}:n)}))},this.abortController),this.setState(e=>{const n=e.messages.find(e=>e.id===o),t=n?.content&&/YOUR WHY IS:/i.test(n.content),r=t?"completed":e.currentPhase;return{messages:e.messages.map(e=>{if(e.id===o){const r=t?(n=e.content)&&/YOUR WHY IS:/i.test(n)?n.split(/(?<=[.!?])\s+/).filter(e=>!e.trim().endsWith("?")).join(" ").trim():n:e.content;return{...e,content:r,isStreaming:!1}}var n;return e}),currentPhase:r,isLoading:!1,isStreaming:!1}});const{currentPhase:i}=this.state;"completed"!==i&&this.analyzeAndUpdatePhase(e)}catch(e){e instanceof Error&&"AbortError"===e.name?this.setState(e=>({messages:e.messages.map(e=>e.id===o?{...e,isStreaming:!1,content:e.content+" [Stopped]"}:e),isLoading:!1,isStreaming:!1})):this.setState({error:`Error: ${e instanceof Error?e.message:"Unknown error"}`,isLoading:!1,isStreaming:!1})}}else this.setState({isLoading:!1})},this.handleSendMessage=()=>{const{inputText:e,isLoading:n}=this.state;e.trim()&&!n&&this.sendCoachMessage(e.trim())},this.handleKeyPress=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),this.handleSendMessage())},this.handleStopGeneration=()=>{this.abortController&&this.abortController.abort()},this.handleModelSelect=e=>{const n=this.state.models.find(n=>n.name===e.target.value);n&&this.setState({selectedModel:n})},this.dismissError=()=>{this.setState({error:""})},this.handleNewSession=()=>{this.setState({messages:[],currentPhase:"intro",sessionData:{...A}},()=>{this.sendCoachMessage("START_SESSION")})},this.chatEndRef=o().createRef(),this.inputRef=o().createRef(),this.state={messages:[],inputText:"",isLoading:!1,error:"",currentTheme:"light",selectedModel:null,models:[],isLoadingModels:!0,isStreaming:!1,isInitializing:!0,sessionStarted:!1,currentPhase:"intro",sessionData:{...A}}}async componentDidMount(){this.aiService=new k(this.props.services),this.initializeTheme(),await this.loadModels(),this.setState({isInitializing:!1},()=>{this.autoStartSession()})}componentWillUnmount(){this.themeChangeListener&&this.props.services?.theme&&this.props.services.theme.removeThemeChangeListener(this.themeChangeListener),this.abortController&&this.abortController.abort()}componentDidUpdate(e,n){this.state.messages.length!==n.messages.length&&this.scrollToBottom()}initializeTheme(){if(this.props.services?.theme){const e=this.props.services.theme.getCurrentTheme();this.setState({currentTheme:e}),this.themeChangeListener=e=>{this.setState({currentTheme:e})},this.props.services.theme.addThemeChangeListener(this.themeChangeListener)}}async loadModels(){if(this.aiService)try{const e=await this.aiService.fetchModels();this.setState({models:e,selectedModel:e.length>0?e[0]:null,isLoadingModels:!1,error:0===e.length?"No AI models available. Please configure a model provider.":""})}catch(e){this.setState({isLoadingModels:!1,error:"Failed to load AI models"})}else this.setState({isLoadingModels:!1,error:"Service not initialized"})}scrollToBottom(){this.chatEndRef.current?.scrollIntoView({behavior:"smooth"})}analyzeAndUpdatePhase(e){const{currentPhase:n,sessionData:t,messages:r}=this.state,s=r.filter(e=>"user"===e.sender).length,o=r.filter(e=>e.phase===n&&"user"===e.sender).length;let a=n,i={...t};e.length>30&&("energy_map"===n&&(i.energizers.length<3?i.energizers=[...t.energizers,e.substring(0,150)]:i.drainers.length<3&&(i.drainers=[...t.drainers,e.substring(0,150)])),"stories"===n&&(i.stories=[...t.stories,e.substring(0,200)])),"intro"===n&&o>=3?a="energy_map":"energy_map"===n&&o>=4?a="stories":"stories"===n&&o>=3&&s>=10?a="your_why":"your_why"===n&&o>=3&&(a="completed"),a===n&&JSON.stringify(i)===JSON.stringify(t)||(console.log(`Phase transition: ${n} -> ${a}`),this.setState({currentPhase:a,sessionData:i}))}renderHeader(){const{models:e,selectedModel:n,isLoadingModels:t}=this.state;return(0,r.jsxs)("div",{className:"why-header",children:[(0,r.jsx)("div",{className:"header-left",children:(0,r.jsx)("span",{className:"header-title",children:"ðŸ§­ Why Discovery"})}),(0,r.jsx)("div",{className:"header-right",children:(0,r.jsx)("select",{className:"model-select",value:n?.name||"",onChange:this.handleModelSelect,disabled:t,children:e.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.name))})})]})}renderMessages(){const{messages:e,isStreaming:n}=this.state;return(0,r.jsxs)("div",{className:"why-chat",children:[e.map(e=>(0,r.jsx)("div",{className:`chat-message ${e.sender}`,children:(0,r.jsxs)("div",{className:"message-bubble "+(e.isStreaming?"streaming":""),children:[(0,r.jsx)(a.oz,{remarkPlugins:[i.A],children:e.content}),e.isStreaming&&(0,r.jsx)("span",{className:"typing-cursor",children:"â–‹"})]})},e.id)),(0,r.jsx)("div",{ref:this.chatEndRef})]})}renderInput(){const{inputText:e,isLoading:n,isStreaming:t,currentPhase:s}=this.state;return"completed"===s?(0,r.jsx)("div",{className:"why-input",children:(0,r.jsxs)("div",{className:"session-complete",children:[(0,r.jsx)("span",{children:"âœ… Session Complete"}),(0,r.jsx)("button",{className:"btn-secondary",onClick:this.handleNewSession,children:"Start New Session"})]})}):(0,r.jsxs)("div",{className:"why-input",children:[(0,r.jsx)("div",{className:"input-wrapper",children:(0,r.jsx)("textarea",{ref:this.inputRef,className:"input-textarea",value:e,onChange:e=>this.setState({inputText:e.target.value}),onKeyPress:this.handleKeyPress,placeholder:"Share your thoughts...",disabled:n,rows:1})}),t?(0,r.jsx)("button",{className:"btn-stop",onClick:this.handleStopGeneration,children:"â– "}):(0,r.jsx)("button",{className:"btn-send",onClick:this.handleSendMessage,disabled:!e.trim()||n,children:"âž¤"})]})}render(){const{currentTheme:e,isInitializing:n,isLoadingModels:t,error:s,sessionStarted:o,models:a}=this.state,i=n||t,l=!i&&0===a.length;return(0,r.jsxs)("div",{className:"why-detector "+("dark"===e?"dark-theme":""),children:[s&&(0,r.jsxs)("div",{className:"error-banner",children:[(0,r.jsxs)("span",{children:["âš ï¸ ",s]}),(0,r.jsx)("button",{className:"error-dismiss",onClick:this.dismissError,children:"Ã—"})]}),i?(0,r.jsxs)("div",{className:"loading-container",children:[(0,r.jsx)("div",{className:"loading-spinner"}),(0,r.jsx)("p",{children:"Loading models..."})]}):l?(0,r.jsx)("div",{className:"loading-container",children:(0,r.jsx)("p",{children:"âš ï¸ No AI models available. Please configure a model provider in Settings."})}):(0,r.jsxs)("div",{className:"why-session",children:[this.renderHeader(),this.renderMessages(),this.renderInput()]})]})}}const O=I,R=I},423:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(601),s=t.n(r),o=t(314),a=t.n(o)()(s());a.push([e.id,"/**\n * BrainDriveWhyDetector Styles\n * Matching BrainDriveChat color scheme and design\n */\n\n/* ============================================================================\n   CSS VARIABLES - Matching BrainDriveChat\n   ============================================================================ */\n.why-detector {\n  --bg-color: #ffffff;\n  --paper-bg: #ffffff;\n  --text-color: #333333;\n  --border-color: rgba(0, 0, 0, 0.2);\n  --hover-color: rgba(0, 0, 0, 0.1);\n  --input-bg: #ffffff;\n  --button-primary-bg: #2196f3;\n  --button-primary-text: #ffffff;\n  --button-secondary-bg: #e0e0e0;\n  --button-secondary-text: #333333;\n  --status-error-color: #f44336;\n  --status-success-color: #4caf50;\n  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n}\n\n.why-detector.dark-theme {\n  --bg-color: #121a28;\n  --paper-bg: #1a2332;\n  --text-color: #e0e0e0;\n  --border-color: rgba(255, 255, 255, 0.1);\n  --hover-color: rgba(255, 255, 255, 0.1);\n  --input-bg: #1e293b;\n  --button-secondary-bg: #2c3a4f;\n  --button-secondary-text: #ffffff;\n  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);\n  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4);\n  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5);\n}\n\n/* ============================================================================\n   BASE CONTAINER\n   ============================================================================ */\n.why-detector {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n  color: var(--text-color);\n  background-color: var(--bg-color);\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  position: relative;\n}\n\n/* ============================================================================\n   WELCOME SCREEN - Simplified\n   ============================================================================ */\n.why-welcome {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 1.5rem;\n  overflow-y: auto;\n  background-color: var(--paper-bg);\n}\n\n.welcome-content {\n  max-width: 480px;\n  text-align: center;\n}\n\n.welcome-icon {\n  font-size: 48px;\n  margin-bottom: 12px;\n}\n\n.welcome-content h1 {\n  font-size: 24px;\n  font-weight: 600;\n  margin: 0 0 8px;\n  color: var(--text-color);\n}\n\n.welcome-subtitle {\n  font-size: 14px;\n  color: var(--text-color);\n  opacity: 0.7;\n  margin: 0 0 20px;\n}\n\n.welcome-description {\n  text-align: left;\n  background: var(--input-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  padding: 16px;\n  margin-bottom: 20px;\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.welcome-description p {\n  margin: 0 0 8px;\n}\n\n.welcome-description p:last-child {\n  margin-bottom: 0;\n}\n\n/* Phase preview - simplified */\n.welcome-phases {\n  text-align: left;\n  margin-bottom: 20px;\n}\n\n.welcome-phases h3 {\n  font-size: 14px;\n  font-weight: 600;\n  margin: 0 0 10px;\n  color: var(--text-color);\n}\n\n.phase-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.phase-preview {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 8px 12px;\n  background: var(--input-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 6px;\n}\n\n.phase-number {\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--button-primary-bg);\n  color: white;\n  border-radius: 50%;\n  font-size: 11px;\n  font-weight: 600;\n  flex-shrink: 0;\n}\n\n.phase-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.phase-info strong {\n  font-size: 13px;\n  font-weight: 500;\n  color: var(--text-color);\n}\n\n.phase-info span {\n  font-size: 11px;\n  color: var(--text-color);\n  opacity: 0.6;\n}\n\n/* Disclaimer */\n.welcome-disclaimer {\n  display: flex;\n  align-items: flex-start;\n  gap: 10px;\n  text-align: left;\n  padding: 12px;\n  border-radius: 6px;\n  margin-bottom: 20px;\n  font-size: 12px;\n  background: rgba(33, 150, 243, 0.08);\n  border: 1px solid rgba(33, 150, 243, 0.2);\n  color: var(--text-color);\n}\n\n.welcome-warning,\n.welcome-error {\n  display: flex;\n  align-items: flex-start;\n  gap: 10px;\n  text-align: left;\n  padding: 12px;\n  border-radius: 6px;\n  margin-bottom: 20px;\n  font-size: 12px;\n}\n\n.welcome-warning {\n  background: rgba(255, 152, 0, 0.1);\n  border: 1px solid rgba(255, 152, 0, 0.3);\n}\n\n.welcome-error {\n  background: rgba(244, 67, 54, 0.1);\n  border: 1px solid var(--status-error-color);\n  color: var(--status-error-color);\n}\n\n.disclaimer-icon {\n  font-size: 16px;\n  flex-shrink: 0;\n}\n\n/* Welcome actions */\n.welcome-actions {\n  display: flex;\n  gap: 10px;\n  justify-content: center;\n  flex-wrap: wrap;\n  margin-bottom: 12px;\n}\n\n.welcome-time {\n  font-size: 12px;\n  color: var(--text-color);\n  opacity: 0.6;\n}\n\n/* ============================================================================\n   BUTTONS - Matching BrainDriveChat\n   ============================================================================ */\n.btn-primary {\n  background: var(--button-primary-bg);\n  color: var(--button-primary-text);\n  border: none;\n  padding: 10px 24px;\n  font-size: 14px;\n  font-weight: 500;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.btn-primary:hover:not(:disabled) {\n  opacity: 0.9;\n}\n\n.btn-primary:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: var(--button-secondary-bg);\n  color: var(--button-secondary-text);\n  border: 1px solid var(--border-color);\n  padding: 10px 20px;\n  font-size: 14px;\n  font-weight: 500;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.btn-secondary:hover {\n  background: var(--hover-color);\n}\n\n/* ============================================================================\n   SESSION LAYOUT\n   ============================================================================ */\n.why-session {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n  background-color: var(--paper-bg);\n  border-radius: 8px;\n  box-shadow: var(--shadow-lg);\n}\n\n/* ============================================================================\n   HEADER - Matching BrainDriveChat\n   ============================================================================ */\n.why-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.75rem 1rem;\n  background: var(--paper-bg);\n  border-bottom: 1px solid var(--border-color);\n  flex-shrink: 0;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.header-title {\n  font-size: 14px;\n  font-weight: 600;\n  color: var(--text-color);\n}\n\n.header-right {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.model-select {\n  padding: 6px 10px;\n  font-size: 12px;\n  background: var(--input-bg);\n  color: var(--text-color);\n  border: 1px solid var(--border-color);\n  border-radius: 6px;\n  cursor: pointer;\n}\n\n.model-select:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n}\n\n.btn-get-why {\n  padding: 6px 12px;\n  font-size: 12px;\n  font-weight: 500;\n  background: linear-gradient(135deg, #10b981, #059669);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.btn-get-why:hover:not(:disabled) {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);\n}\n\n.btn-get-why:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Phase indicator - simplified */\n.phase-indicator {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  position: relative;\n}\n\n.phase-dots {\n  display: flex;\n  gap: 4px;\n}\n\n.phase-dot {\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  background: var(--border-color);\n  transition: all 0.2s;\n}\n\n.phase-dot.completed {\n  background: #9ca3af; /* Grey for completed phases */\n}\n\n.phase-dot.active {\n  background: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.3);\n  transform: scale(1.2);\n}\n\n.phase-label {\n  font-size: 12px;\n  font-weight: 500;\n  color: var(--text-color);\n  opacity: 0.8;\n}\n\n.phase-info-btn {\n  width: 16px;\n  height: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--input-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 50%;\n  font-size: 10px;\n  color: var(--text-color);\n  opacity: 0.6;\n  cursor: pointer;\n}\n\n.phase-details-popup {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  margin-top: 6px;\n  padding: 10px;\n  background: var(--paper-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 6px;\n  box-shadow: var(--shadow-md);\n  z-index: 100;\n  min-width: 180px;\n}\n\n.phase-details-popup h4 {\n  margin: 0 0 4px;\n  font-size: 13px;\n  color: var(--text-color);\n}\n\n.phase-details-popup p {\n  margin: 0;\n  font-size: 12px;\n  color: var(--text-color);\n  opacity: 0.7;\n}\n\n/* ============================================================================\n   CHAT AREA - Matching BrainDriveChat\n   ============================================================================ */\n.why-chat {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 1rem 1rem 4rem;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  scrollbar-width: thin;\n  scrollbar-color: var(--border-color) transparent;\n  min-height: 0;\n  height: 0;\n}\n\n.why-chat::-webkit-scrollbar {\n  width: 6px;\n}\n\n.why-chat::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.why-chat::-webkit-scrollbar-thumb {\n  background-color: var(--border-color);\n  border-radius: 3px;\n}\n\n/* Messages - Matching BrainDriveChat */\n.chat-message {\n  display: flex;\n  width: 100%;\n}\n\n.chat-message.user {\n  justify-content: flex-end;\n}\n\n.chat-message.coach {\n  justify-content: flex-start;\n}\n\n.message-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n}\n\n.message-sender {\n  font-size: 12px;\n  font-weight: 600;\n  color: var(--text-color);\n  opacity: 0.8;\n}\n\n.message-time {\n  font-size: 11px;\n  color: var(--text-color);\n  opacity: 0.5;\n}\n\n.message-bubble {\n  max-width: min(720px, 88%);\n  width: fit-content;\n  padding: 1rem 1.25rem;\n  border-radius: 1rem;\n  border: 1px solid var(--border-color);\n  background-color: var(--input-bg);\n  box-shadow: 0 12px 32px rgba(15, 23, 42, 0.06);\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n\n.chat-message.coach .message-bubble:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 16px 40px rgba(15, 23, 42, 0.1);\n}\n\n.chat-message.user .message-bubble {\n  background-color: rgba(0, 0, 0, 0.05);\n  border-color: rgba(0, 0, 0, 0.12);\n  box-shadow: none;\n}\n\n.dark-theme .chat-message.user .message-bubble {\n  background-color: rgba(33, 150, 243, 0.2);\n  border-color: rgba(33, 150, 243, 0.35);\n}\n\n.dark-theme .chat-message.coach .message-bubble {\n  background-color: rgba(255, 255, 255, 0.04);\n  border-color: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 12px 34px rgba(8, 47, 73, 0.55);\n}\n\n.message-bubble.streaming {\n  border-color: rgba(33, 150, 243, 0.4);\n  box-shadow: 0 10px 28px rgba(33, 150, 243, 0.15);\n}\n\n/* Markdown content */\n.message-bubble p {\n  margin: 0 0 8px;\n  line-height: 1.6;\n}\n\n.message-bubble p:last-child {\n  margin-bottom: 0;\n}\n\n.message-bubble strong {\n  font-weight: 600;\n}\n\n.message-bubble ul,\n.message-bubble ol {\n  margin: 8px 0;\n  padding-left: 1.5rem;\n}\n\n.message-bubble li {\n  margin: 4px 0;\n  line-height: 1.5;\n}\n\n.message-bubble code {\n  background: var(--hover-color);\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-family: 'SF Mono', Consolas, monospace;\n  font-size: 13px;\n}\n\n.typing-cursor {\n  display: inline-block;\n  animation: blink 1s infinite;\n  color: var(--button-primary-bg);\n  margin-left: 2px;\n}\n\n@keyframes blink {\n  0%, 50% { opacity: 1; }\n  51%, 100% { opacity: 0; }\n}\n\n/* ============================================================================\n   INPUT AREA - Matching BrainDriveChat\n   ============================================================================ */\n.why-input {\n  display: flex;\n  align-items: flex-end;\n  gap: 8px;\n  padding: 1rem;\n  background: var(--paper-bg);\n  flex-shrink: 0;\n}\n\n.input-wrapper {\n  flex: 1;\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  background: var(--input-bg);\n  transition: border-color 0.2s;\n}\n\n.input-wrapper:focus-within {\n  border-color: var(--button-primary-bg);\n}\n\n.input-textarea {\n  width: 100%;\n  padding: 10px 12px;\n  font-size: 14px;\n  font-family: inherit;\n  line-height: 1.5;\n  background: transparent;\n  color: var(--text-color);\n  border: none;\n  resize: none;\n  overflow-y: auto;\n  max-height: 120px;\n}\n\n.input-textarea:focus {\n  outline: none;\n}\n\n.input-textarea::placeholder {\n  color: var(--text-color);\n  opacity: 0.5;\n}\n\n.btn-send,\n.btn-stop {\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  border-radius: 8px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: all 0.15s;\n  flex-shrink: 0;\n}\n\n.btn-send {\n  background: var(--button-primary-bg);\n  color: white;\n}\n\n.btn-send:hover:not(:disabled) {\n  opacity: 0.9;\n}\n\n.btn-send:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-stop {\n  background: var(--status-error-color);\n  color: white;\n  font-size: 12px;\n}\n\n.btn-stop:hover {\n  opacity: 0.9;\n}\n\n/* Session complete */\n.session-complete {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 12px;\n  width: 100%;\n  padding: 8px;\n}\n\n.session-complete span {\n  font-size: 14px;\n  font-weight: 500;\n  color: var(--status-success-color);\n}\n\n/* ============================================================================\n   SESSION SUMMARY\n   ============================================================================ */\n.session-summary {\n  padding: 1rem;\n  background: rgba(33, 150, 243, 0.05);\n  border-top: 1px solid rgba(33, 150, 243, 0.2);\n  max-height: 250px;\n  overflow-y: auto;\n}\n\n.session-summary h3 {\n  margin: 0 0 12px;\n  font-size: 16px;\n  color: var(--text-color);\n}\n\n.summary-section {\n  margin-bottom: 12px;\n}\n\n.summary-section:last-child {\n  margin-bottom: 0;\n}\n\n.summary-section h4 {\n  margin: 0 0 6px;\n  font-size: 12px;\n  font-weight: 600;\n  color: var(--text-color);\n  opacity: 0.7;\n  text-transform: uppercase;\n}\n\n.summary-section .why-statement {\n  font-size: 16px;\n  font-weight: 500;\n  color: var(--button-primary-bg);\n  font-style: italic;\n}\n\n.summary-section ul {\n  margin: 0;\n  padding-left: 16px;\n  font-size: 13px;\n}\n\n.summary-section li {\n  margin: 3px 0;\n  color: var(--text-color);\n}\n\n/* ============================================================================\n   ERROR BANNER\n   ============================================================================ */\n.error-banner {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 10px 12px;\n  background: rgba(244, 67, 54, 0.1);\n  border-bottom: 1px solid var(--status-error-color);\n  color: var(--status-error-color);\n  font-size: 13px;\n}\n\n.error-dismiss {\n  background: none;\n  border: none;\n  color: var(--status-error-color);\n  font-size: 18px;\n  cursor: pointer;\n  padding: 0 6px;\n  line-height: 1;\n}\n\n/* ============================================================================\n   LOADING STATE\n   ============================================================================ */\n.loading-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 12px;\n  background: var(--paper-bg);\n}\n\n.loading-spinner {\n  width: 32px;\n  height: 32px;\n  border: 3px solid var(--border-color);\n  border-top-color: var(--button-primary-bg);\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n.loading-container p {\n  color: var(--text-color);\n  opacity: 0.7;\n  font-size: 13px;\n}\n\n/* ============================================================================\n   RESPONSIVE\n   ============================================================================ */\n@media (max-width: 640px) {\n  .welcome-content {\n    padding: 12px;\n  }\n\n  .welcome-content h1 {\n    font-size: 20px;\n  }\n\n  .chat-message .message-bubble {\n    max-width: 95%;\n  }\n\n  .why-header {\n    flex-wrap: wrap;\n    gap: 8px;\n  }\n\n  .header-left,\n  .header-right {\n    width: 100%;\n    justify-content: space-between;\n  }\n}\n",""]);const i=a}}]);